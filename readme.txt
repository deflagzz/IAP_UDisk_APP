已完成:驱动初始化,根据心跳来发送初始化命令		--180224

	1.进中断和出中断要进行如下操作
	
	#if SYSTEM_SUPPORT_OS 	
		OSIntEnter();    
	#endif
	
	#if SYSTEM_SUPPORT_OS 	
		OSIntExit();  											 
	#endif

	2.系统延时函数不受限制
	*** OS_OPT_TIME_HMSM_STRICT            strictly allow only hours        (0...99)
															   minutes      (0...59)
															   seconds      (0...59)
															   milliseconds (0...999)
		OS_OPT_TIME_HMSM_NON_STRICT        allow any value of  hours        (0...999)
															   minutes      (0...9999)
															   seconds      (0...65535)
															   milliseconds (0...4294967295)

	讯飞语音模块的音调优化如下:
	speek("滚筒[=tong3]左转");	//[=pinyin数字]	拼音是要发声的拼音,数字是音调

	以及启动停止按钮的语音
	遥控滚筒加一项安全保证
	把滚筒的左右侧上货到中间的延时时间放到触摸屏上 并开一个测试界面  把滚筒的左右上货函数循环执行
	左右侧上货的语音没弄
	语音音量的添加  音调调慢
	驱动器语音 优化为驱动未上电和驱动断电
	语音延时加大 不然会打断语音
	把route文件里的我的程序拿出来
	等板子焊接好测试  红外跟机械的避障  
	出轨的语音会产生两次


//@@////////////////////////////////////////////////////////////////////////////////////////////@@//

//到站停止并对接 虚拟地标





//语音相对应的:		红外机械避障 出轨  低电量      遥控器接通   遥控器拔出		






//跟基站通信
//反馈AGV各种状态以及所走的路程给上位机  到站点路程清零




//上货时红外误触



//手动摇杆控制时被避障后,g_Start_flag.button_Start 会不会被值1 处bug?

//辊筒转速  问 厂家
//自动充电 没电给上位机说 上位机安排


//flash那个5出错时再读一遍确认是否真的出错

87-180-274
70-157-254  92

//出轨寻一次轨的测试


//自动模式下 停止状态 语音避障背触发


1.辊筒调平
2.导轮左右间距调合适
3.左右门把手出问题
//4.自锁按钮开关出问题
5.速度最大1800,再大的话因为PID调节周期为80ms(motec4个电机发送周期),就来不及调节了.
6.分叉用虚拟地标,就可以在两个分叉间距非常小的情况下实现完美分叉


//工位走之前一定判断红外是否不被触发或触发



有时间的话 每个子文件各自一个结构体,不要出现零散全局变量


void  OS_IdleTask (void  *p_arg)
{
    CPU_SR_ALLOC();



    p_arg = p_arg;                                          /* Prevent compiler warning for not using 'p_arg'         */

    while (DEF_ON) {
        CPU_CRITICAL_ENTER();
        OSIdleTaskCtr++;
#if OS_CFG_STAT_TASK_EN > 0u
        OSStatTaskCtr++;
#endif
        CPU_CRITICAL_EXIT();

        OSIdleTaskHook();                                   /* Call user definable HOOK                               */
    }
}



明天:
//跟上位机通信所需准备的对接信息
//根据信息做出动作
明天任务:
//需要发送数据的填充
//路径的执行与PLC交互
//把跟PLC炉子滚筒的信号标志加到滚筒函数中
//确定是否只有一个托盘?
//炉子ID加到屏幕跟路径里
//滚筒红外的消抖在底层做
//滚筒红外消抖在上层做了
明天:
//报警信息的填充
//执行充电路径即为充电状态 -- 充电模式未加
//充电完成未加
//手动界面加一个待命模式按键	
//运行状态加个0:未就绪	
//未关机充电加上
//切手动 或者充电就是非就绪

{
	超时发送的时间多久,长的话就关掉
	把通信超时时间跟次数加到屏幕上
}


//测试出轨等一系列警告信息

//在用户界面把所以的工位路径添加出来		


{
	意外断电或者取消任务后 上位机备份此时任务跟位置 速度 方向 分叉方向 等待
	重新上电后发给AGV去执行				

	或直接开到起点重新开始
	//任务被取消  -- 孙总说正常情况不用管
}





//添加语音

//加个去充电的语音
//胶条未裁剪
//3.左右门把手出问题


未完成:
行车灯的各种状态:   红外机械避障 出轨  低电量
1.辊筒调平
2.导轮左右间距调合适

备用电池接头未制作

红外未打开
 
 屏幕红外跟机械开关为总开关 
 
	PID调节时间由80ms提升到10ms, 记得在屏幕上设置时间为10ms 
	去北京现场把PID参数看看 是否需要调整
 
 
看门狗复位后 从上位机寄存器读任务及AGV状态  复原之前的行动
或者 直接报错 等待人工开去原点复位


地标图示 备份
各种报警状态也黄灯流动
